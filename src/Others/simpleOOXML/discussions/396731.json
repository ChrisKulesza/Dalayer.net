[
  {
    "Id": "916873",
    "ThreadId": "396731",
    "Html": "\r\n<p>I have an ASP.NET MVC3 project and it uses OOXML and it takes a really long time to write an excel file with ~36,000 rows. I tried a bunch of different ways to speed this up to no avail. The bottleneck comes when writing to the document:</p>\r\n<p>&nbsp;</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>        <span style=\"color:blue\">private</span> <span style=\"color:blue\">static</span> <span style=\"color:blue\">void</span> WriteValues(<span style=\"color:blue\">string</span> cellLocation, <span style=\"color:blue\">string</span> strValue, SpreadsheetDocument spreadSheet, WorksheetPart workSheet) {\r\n            WorksheetWriter workSheetWriter = <span style=\"color:blue\">new</span> WorksheetWriter(spreadSheet, workSheet);\r\n            \r\n            <span style=\"color:blue\">int</span> intValue = 0;\r\n            <span style=\"color:blue\">if</span> (strValue.Contains(<span style=\"color:#a31515\">&quot;$&quot;</span>)) {\r\n                strValue = strValue.Replace(<span style=\"color:#a31515\">&quot;$&quot;</span>, <span style=\"color:#a31515\">&quot;&quot;</span>);\r\n                strValue = strValue.Replace(<span style=\"color:#a31515\">&quot;,&quot;</span>, <span style=\"color:#a31515\">&quot;&quot;</span>);\r\n\r\n                workSheetWriter.PasteValue(cellLocation, strValue, CellValues.Number);\r\n            } <span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span> (<span style=\"color:blue\">int</span>.TryParse(strValue, <span style=\"color:blue\">out</span> intValue)) {\r\n                workSheetWriter.PasteValue(cellLocation, strValue, CellValues.Number);\r\n            } <span style=\"color:blue\">else</span> <span style=\"color:blue\">if</span> (<span style=\"color:blue\">string</span>.IsNullOrEmpty(strValue)) {\r\n                workSheetWriter.PasteText(cellLocation, strValue);\r\n            } <span style=\"color:blue\">else</span> {\r\n                workSheetWriter.PasteText(cellLocation, strValue);\r\n            }\r\n        }\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>The paste value is really inefficient here and I was wondering if there is anyway to create the row and just do an append?</p>\r\n<p>&nbsp;</p>\r\n<p>Thank you!</p>\r\n",
    "PostedDate": "2012-09-24T13:53:23.053-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]